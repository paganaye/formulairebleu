var de=e=>{throw TypeError(e)};var me=(e,n,a)=>n.has(e)||de("Cannot "+a);var P=(e,n,a)=>(me(e,n,"read from private field"),a?a.call(e):n.get(e)),H=(e,n,a)=>n.has(e)?de("Cannot add the same private member more than once"):n instanceof WeakSet?n.add(e):n.set(e,a),U=(e,n,a,r)=>(me(e,n,"write to private field"),r?r.call(e,a):n.set(e,a),a);(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))r(l);new MutationObserver(l=>{for(const i of l)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function a(l){const i={};return l.integrity&&(i.integrity=l.integrity),l.referrerPolicy&&(i.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?i.credentials="include":l.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(l){if(l.ep)return;l.ep=!0;const i=a(l);fetch(l.href,i)}})();function je(e){e.preventDefault(),e.stopPropagation();let n=document.activeElement;n instanceof HTMLElement&&setTimeout(()=>{n.focus()})}const ye=new Map;function $(e="id"){e=$e(e);let n=(ye.get(e)??0)+1;return ye.set(e,n),`${e}${n}`}function $e(e){return e.trim().replace(/ /g,"_").replace(/[^a-zA-Z0-9_-]/g,"").replace(/^([^a-zA-Z_])/,"_$1").replace(/([0-9])$/,"$1_").replace(/__+/g,"_")}class T{}function ae(e){return e&&typeof e.getValue=="function"}const Ne=new Set(["value","checked","selected","disabled","readOnly","className","id","href","src"]);var J;class Z{constructor(n){H(this,J);this.id=$(n??this.constructor.name)}addObserver(n,a=!1){(P(this,J)||U(this,J,new Set)).add(n),a&&n(this.getValue())}notifyObservers(n){var a;(a=P(this,J))==null||a.forEach(r=>r(n))}}J=new WeakMap;var K;class x extends Z{constructor(a,r=void 0){super(a);H(this,K);U(this,K,r)}getValue(){return P(this,K)}setValue(a,r={notify:!0}){a===P(this,K)&&!r.forceUpdate||(U(this,K,a),r.notify&&this.notifyObservers(a))}}K=new WeakMap;function ie(e,n,a){ae(e)?(n(e.getValue()),e.addObserver(n)):n(e)}function E(e){if(e===void 0)return[document.createComment($("undefined-source"))];if(e===null)return[document.createComment($("null-source"))];const n=typeof e;if(["string","number","boolean"].includes(n))return[document.createTextNode(e.toString())];if(n=="object"){if(ae(e)){let a=E(e.getValue());const r=l=>{var d,y;const i=(d=a[a.length-1])==null?void 0:d.nextSibling,o=E(l);o.length==0&&o.push(document.createComment($(e.id+"-placeholder")));const s=(y=a[0])==null?void 0:y.parentNode;s&&(a.forEach(c=>{var b;return(b=c.parentNode)==null?void 0:b.removeChild(c)}),o.forEach(c=>s.insertBefore(c,i))),a.length=0,a.push(...o)};return e.addObserver(r),a}return Array.isArray(e)?e.flatMap(E):e instanceof Node?[e]:[document.createTextNode(String(e))]}if(n==="function")return E(e());throw Error("Unexpected JSX child "+e)}function t(e,n,...a){switch(typeof e){case"string":const l=document.createElement(e);return n&&Object.keys(n).forEach(i=>{let o=n[i];i=="ref"&&o instanceof Z&&setTimeout(()=>o.setValue(l)),i.startsWith("on")&&typeof o=="function"?l.addEventListener(i.slice(2).toLowerCase(),o):(o===void 0&&(o=""),ae(o)?ie(o,s=>r(l,i,s)):r(l,i,o))}),a.forEach(i=>{E(i).forEach(o=>{l.appendChild(o)})}),l;case"function":return e===T?a.flatMap(E):e(n||{},a);default:throw Error("Unexpected JSX element "+e)}function r(l,i,o){Ne.has(i)?l[i]=o:(o===!0&&(o=""),o===!1?l.removeAttribute(i):l.setAttribute(i,o))}}function S(e,n){const a=n[0];if(typeof a!="function")throw new Error("For expects its child to be a function");const r=new x("ForContent",[]),l=i=>{const o=[];i==null||i.forEach((s,d)=>{o.push(...E(a(s,d)))}),o.length==0&&o.push(document.createComment($("For-placeholder"))),r.setValue(o)};return ie(e.each,l),r}function Fe(e,n=document.body){E(e).forEach(a=>n.appendChild(a))}function v(e,n,a){const r={},l=new x(e,void 0);for(const i in n){const o=n[i];r[i]=o.getValue(),o.addObserver(s=>{r[i]=s;let d=a(r);l.setValue(d)})}return l.setValue(a(r)),l}function O(e,n){let a=e.when;for(;typeof a=="function";)a=a();if(a instanceof Z){const r=new x("show",void 0);return ie(a,l=>r.setValue(l?n:e.fallback)),r}else return a?n:e.fallback}const ue=class ue{static add(n,a){try{const r=Object.entries(a).map(([l,i])=>`${this.camelToKebab(l)}: ${i};`).join(" ");this.styleSheet.insertRule(`${n} { ${r} }`,this.styleSheet.cssRules.length)}catch(r){console.error(r)}}static camelToKebab(n){return n.replace(/[A-Z]/g,a=>`-${a.toLowerCase()}`)}};ue.styleSheet=(()=>{const n=document.createElement("style");return document.head.appendChild(n),n.sheet})();let A=ue,re=new x("currentPage",document.location.hash);A.add("a.link.selected",{textDecoration:"none"});window.onhashchange=e=>{re.setValue(document.location.hash)};function G(e,...n){return t("a",{id:e.href.substring(1),class:v("selected",{currentPage:re},a=>a.currentPage==e.href?"link selected":"link"),href:e.href==""?"#":e.href},n)}let pe={welcome:"Welcome",menu_home:"Home",menu_form_editor:"Form Editor",menu_tests:"Tests",menu_about:"About"},Le={...pe,welcome:"Bienvenue",menu_home:"Accueil",menu_form_editor:"Éditeur de formulaire",menu_tests:"Tests",menu_about:"À propos"},le=navigator.language.toLowerCase().startsWith("fr")?"fr":"en",Y=le=="fr"?Le:pe;document.documentElement.setAttribute("lang",le);console.log("Language:",le);A.add("nav.main-nav > a",{margin:"5px"});A.add("nav.main-nav > a.active",{margin:"15px"});function W(){return t(T,null,t("nav",{class:"main-nav"},t(G,{href:""},Y.menu_home),t(G,{href:"#form-editor"},Y.menu_form_editor),t(G,{href:"#tests"},Y.menu_tests),t(G,{href:"#about"},Y.menu_about)))}function Pe(){return t(T,null,t("div",{class:"container"},t(W,null),t("h1",null,"A propos de Formulaire Bleu"),t("p",null,"Formulaire bleu est développé par Pascal GANAYE"),t("p",null,"Formulaire Bleu ne stocke pas vos données. Vos formulaires et leurs données résident sur votre propre fichier Google Docs ou sur votre serveur."),t("p",null,"Formulaire Bleu est entièrement gratuit et open source. Distribué  sur ",t("a",{href:"https://github.com/paganaye/formulairebleu"},"github.com")," sous une licence permissive (MIT License), il vous permet de l'utiliser, de le modifier et de le redistribuer librement, que ce soit dans des projets personnels ou commerciaux."),t("p",null,"Si vous avez une suggestion d’amélioration, si vous rencontrez un bug ou si vous souhaitez me contacter, veuillez ",t("a",{href:"https://github.com/paganaye/formulairebleu/issues/new"},"créer un ticket"))))}var R;const X=class X extends Z{constructor(a,r,l,i){super();H(this,R);this.engine=a,this.parent=r,this.name=l,this.uniqueId=X.getUniqueId(),this.errors=new x("boxErrors",[]),this.pageNo=new x("boxPageNo",{startPage:0,startLine:0,endPage:0,endLine:0});let o=a.templates&&a.templates[i.type];this.type=o??i}static getUniqueId(){return++X.lastBoxId}addChildChangedObserver(a,r=!1){(P(this,R)||U(this,R,new Set)).add(a),r&&a({box:this,pageChanged:!1})}notifyChildChanged(a,r){P(this,R)&&P(this,R).forEach(l=>l({box:a,pageChanged:r})),this.parent&&this.parent.notifyChildChanged(a,r)}clearErrors(){this.errors.setValue([])}validate(a){const r=[];this.engine.validate(this,a,this.type.validations,r),this.errors.setValue(r)}static enBox(a,r,l,i,o){let s;switch(i=a.getActualType(i),i.type){case"number":s=new Ke(a,r,l,i),o==null&&(o=i.defaultValue);break;case"boolean":s=new Re(a,r,l,i),o==null&&(o=i.defaultValue);break;case"object":s=new be(a,r,l,i);break;case"array":s=new Me(a,r,l,i);break;case"variant":s=new Je(a,r,l,i);break;case"string":case"date":case"time":case"datetime":s=new Ee(a,r,l,i),o==null&&(o=i.defaultValue);break;case"const":s=new _e(a,r,l,i);break;default:throw new Error("Cannot box "+i.type)}return s.setValue(o??null,{notify:!0,validate:!0}),s}paginate(){this.parent?this.parent.paginate():this.engine.paginate(this)}static unBox(a){return a.getValue()}getDefaultValue(){return this.engine.getTypeDefaultValue(this.type)}};R=new WeakMap,X.lastBoxId=0;let C=X;class Ee extends C{getValue(){return this.value}setValue(n,a={notify:!0,validate:!0}){(!n||typeof n!="string")&&(n=null),n!==this.value&&(this.value=n,this.notifyObservers(this.value),this.notifyChildChanged(this,!1))}}class _e extends C{getValue(){return this.type.value}setValue(n,a={notify:!0,validate:!0}){}}class Ke extends C{getValue(){return this.value}setValue(n,a){(n==null||typeof n!="number"||isNaN(this.value))&&(n=null),n!==this.value&&(this.value=n,this.notifyObservers(this.value),this.notifyChildChanged(this,!1))}}class Re extends C{getValue(){return this.value}setValue(n,a){(n==null||typeof n!="boolean")&&(n=null),n!==this.value&&(this.value=n,this.notifyObservers(this.value),this.notifyChildChanged(this,!1))}}class be extends C{constructor(n,a,r,l){super(n,a,r,l),this.value={},this.members=(l.membersTypes??[]).map(i=>{var s;let o=C.enBox(n,this,i.key,i,(s=this.value)==null?void 0:s[i.key]);return o.addObserver(()=>{let d=o.getValue();this.value[i.key]=d,super.notifyChildChanged(this,!1)}),this.value[i.key]=o.getValue(),o})}getValue(){return this.value}setValue(n,a){if(n&&typeof n=="object")for(let r of this.members){let l=n[r.type.key];r.setValue(l,{notify:!0,validate:!0})}}getMembers(){return this.members}}class Me extends C{constructor(n,a,r,l,i){super(n,a,r,l),this.value=[],this.entryBoxes=new x("arrayBoxEntryBoxes",this.getDefaultValue())}getValue(){let n=this.entryBoxes;return n?n.getValue().map(a=>a.getValue()):[]}setValue(n,a){Array.isArray(n)||(n=[]),this.value.length=0,this.value.push(...n);let r=n.map((l,i)=>C.enBox(this.engine,this,`${this.name}#${i}`,this.type.entryType,l));this.entryBoxes.setValue(r),this.notifyObservers(n),this.notifyChildChanged(this,!0)}}class Je extends C{constructor(n,a,r,l,i){super(n,a,r,l),this._value=this.type.flat?null:{type:void 0,value:void 0},this.typeKey=new x("variantKey",void 0),this.variantInnerBox=new x("variantInnerBox"),this.typeKey.addObserver(o=>{let s=this.type.variants.find(c=>c.key===o)??this.type.variants[0],d=s?n.getTypeDefaultValue(s):void 0,y=C.enBox(this.engine,this,this.name,s,d);this.variantInnerBox.setValue(y),y.addObserver(()=>{let c=this.typeKey.getValue(),b=y.getValue();this.type.flat?this.type.determinant&&c&&b&&typeof b=="object"&&(b[this.type.determinant]=c):b={type:c,value:b},this.setValue(b,{notify:!0,validate:!1})},!0)},!0)}getValue(){return this._value}setValue(n,a){let r,l;if(this.type.flat){let i=Array.isArray(n)?"array":n==null?"null":typeof n,o=null;for(let d of this.type.variants)if(d.type===i&&(i!="object"||!this.type.determinant||n[this.type.determinant]==d.key)){o=d.key;break}let s=this.typeKey.getValue();o&&(o!=s||n!=this._value)&&(this.typeKey.setValue(o),this.variantInnerBox.getValue().setValue(n,{notify:!0,validate:!1}),this._value=n,this.type.determinant&&(n[this.type.determinant]=o),this.notifyObservers(n))}else n&&typeof n=="object"&&"type"in n?(r=n.type,l=n.value):n={},(r!=this._value.type||l!=this._value.value)&&(this.typeKey.setValue(r),this._value.type=r,this.variantInnerBox.getValue().setValue(l,{notify:!0,validate:!1}),this._value.value=this.variantInnerBox.getValue().getValue(),this.notifyObservers(n));this.notifyChildChanged(this,!0)}getDefaultValue(){return{key:this.type.variants[0].key,value:C.enBox(this.engine,null,this.name,this.type.variants[0],void 0).getDefaultValue()}}getVariants(){return this.type.variants}notifyChildChanged(n,a){super.notifyChildChanged(n,a)}}A.add(".error",{color:"red"});function M(e){return t(O,{when:e},t("div",{class:"error"},e.error))}function ze(e){return t(O,{when:e.errors},t("div",{class:"errors"},t(S,{each:e.errors},n=>t(M,{error:n}))))}A.add(".form-span-label",{color:"#888",marginLeft:"0.5em",minWidth:"15%"});A.add(".form-span-content",{minWidth:"25%"});class qe{constructor(n){this.isReadonly=!1,this.pageNo=new x("formPageNo",1),this.pageCount=new x("formPageCount",1),this.rePaginationCount=new x("formRepaginationCount",1),this.templates=n??{}}getActualType(n){var l;let a=(l=n==null?void 0:n.view)==null?void 0:l.type,r;if(a&&(r=this.templates[a]),!r){let i=n==null?void 0:n.type;r=this.templates&&this.templates[i]}return r??n}paginate(n){let a=1,r=0,l=!1,i=o=>{let s=o.type,d=this.getActualType(s);(s.pageBreak||d.pageBreak)&&r>0&&(a+=1,r=0);let y=a,c=r;switch(d.type){case"array":let p=o.entryBoxes;for(let B of p.getValue())i(B);break;case"object":let f=o.getMembers();for(let B of f)i(B);break;case"variant":let g=o.variantInnerBox.getValue();g&&i(g);break;case"boolean":case"const":case"number":case"string":r+=1;break}!l&&y!=o.pageNo.getValue().startPage&&(l=!0),o.pageNo.setValue({startPage:y,startLine:c,endPage:a,endLine:r})};i(n),this.pageCount.setValue(a),l&&this.rePaginationCount.setValue(this.rePaginationCount.getValue()+1)}FormBody(n){return new x("formBodyRootBox",void 0).addObserver(r=>{console.log("hi")}),t("div",{class:"container"},n.header,n.footer)}InputRenderer(n){let a=this.getRenderer(n.box.type);const r=v("inputRenderIsVisible",{page:this.pageNo,box:n.box.pageNo},l=>{let i=l.box;if(!i)return!0;let o=l.page;return o==0?!0:i.startPage<=o&&(i.endPage==0||o<=i.endPage)});return t(T,null,t(O,{when:r},a==null?void 0:a(n)))}InputTop(n){return t(T,null,t(O,{when:n.box.type.help},t("div",{class:"form-label text-body-tertiary"},t("small",null,n.box.type.help))))}InputBottom(n){return t(T,null,t(ze,{errors:n.box.errors}))}Title(n){let a;return n.parentType.key,t(T,null,a)}isBoxVisible(n){let a=this.pageNo.getValue(),r=n.pageNo.getValue();return!r||r.startPage==0||!a?!0:r.startPage<=a&&a<=r.endPage}validate(n,a,r,l){var L;const i=n.name,o={array:d,boolean:y,const:c,date:b,datetime:p,number:f,object:g,string:B,time:I,variant:j,void:F};r!=null&&((L=o[n.type.type])==null||L.call(o,r));function s(u,h){const V=typeof u=="object"&&typeof u.message=="string"?u.message:h;l.push(V)}function d(u){if(u.mandatory&&(a==null||Array.isArray(a)&&a.length===0)&&s(u.mandatory,`${i} is mandatory.`),u.minLength){const h=typeof u.minLength=="number"?u.minLength:u.minLength.value;Array.isArray(a)&&a.length<h&&s(u.minLength,`${i} must have at least ${h} items.`)}if(u.maxLength){const h=typeof u.maxLength=="number"?u.maxLength:u.maxLength.value;Array.isArray(a)&&a.length>h&&s(u.maxLength,`${i} must have at most ${h} items.`)}}function y(u){u.mandatory&&a==null&&s(u.mandatory,`${i} is mandatory.`)}function c(u){u.mandatory&&(a==null||a==="")&&s(u.mandatory,`${i} is mandatory.`)}function b(u){u.mandatory&&(!a||a==="")&&s(u.mandatory,`${i} is mandatory.`);const h=new Date(String(a));if(u.minDate){const V=typeof u.minDate=="string"?u.minDate:u.minDate.value,m=new Date(V);h<m&&s(u.minDate,`${i} must be on or after ${m.toISOString().split("T")[0]}.`)}if(u.maxDate){const V=typeof u.maxDate=="string"?u.maxDate:u.maxDate.value,m=new Date(V);h>m&&s(u.maxDate,`${i} must be on or before ${m.toISOString().split("T")[0]}.`)}}function p(u){u.mandatory&&(!a||a==="")&&s(u.mandatory,`${i} is mandatory.`);const h=new Date(String(a));if(u.minDate){const V=typeof u.minDate=="string"?u.minDate:u.minDate.value,m=new Date(V);h<m&&s(u.minDate,`${i} must be on or after ${m.toISOString()}.`)}if(u.maxDate){const V=typeof u.maxDate=="string"?u.maxDate:u.maxDate.value,m=new Date(V);h>m&&s(u.maxDate,`${i} must be on or before ${m.toISOString()}.`)}if(u.minTime){const V=typeof u.minTime=="string"?u.minTime:u.minTime.value;h.toTimeString().slice(0,5)<V&&s(u.minTime,`${i} must be after ${V}.`)}if(u.maxTime){const V=typeof u.maxTime=="string"?u.maxTime:u.maxTime.value;h.toTimeString().slice(0,5)>V&&s(u.maxTime,`${i} must be before ${V}.`)}}function f(u){var V;u.mandatory&&(a===null||a===""||Number.isNaN(Number(a)))&&s(u.mandatory,`${i} is mandatory.`);const h=Number(a);if(u.minValue){const m=typeof u.minValue=="number"?u.minValue:u.minValue.value;h<m&&s(u.minValue,`${i} must be at least ${m}.`)}if(u.maxValue){const m=typeof u.maxValue=="number"?u.maxValue:u.maxValue.value;h>m&&s(u.maxValue,`${i} must be at most ${m}.`)}if(u.maxDecimals!==void 0){const m=typeof u.maxDecimals=="number"?u.maxDecimals:u.maxDecimals.value;(((V=a.toString().split(".")[1])==null?void 0:V.length)||0)>m&&s(u.maxDecimals,`${i} must have at most ${m} decimal places.`)}}function g(u){u.mandatory&&a==null&&s(u.mandatory,`${i} is mandatory.`)}function B(u){if(u.mandatory&&(a===null||a==="")&&s(u.mandatory,`${i} is mandatory.`),u.minLength){const h=typeof u.minLength=="number"?u.minLength:u.minLength.value;String(a).length<h&&s(u.minLength,`${i} must have at least ${h} characters.`)}if(u.maxLength){const h=typeof u.maxLength=="number"?u.maxLength:u.maxLength.value;String(a).length>h&&s(u.maxLength,`${i} must have at most ${h} characters.`)}if(u.regex){let h=Array.isArray(u.regex)?u.regex:[u.regex];for(let V of h){const m=typeof V=="string"?V:V.regex;new RegExp(m).test(String(a))||s(V,`Does not match expression ${m}.`)}}}function I(u){if(u.mandatory&&(a===null||a==="")&&s(u.mandatory,`${i} is mandatory.`),u.minTime){const h=typeof u.minTime=="string"?u.minTime:u.minTime.value;String(a)<h&&s(u.minTime,`${i} must be after ${h}.`)}if(u.maxTime){const h=typeof u.maxTime=="string"?u.maxTime:u.maxTime.value;String(a)>h&&s(u.maxTime,`${i} must be before ${h}.`)}}function j(u){u.mandatory&&(a===null||a==="")&&s(u.mandatory,`${i} is mandatory.`)}function F(u){u.mandatory&&(a===null||a==="")&&s(u.mandatory,`${i} is mandatory.`)}}Span(n){let a=new x("BoxSpan",["..."]);n.addChildChangedObserver(()=>{a.setValue(r(1,n))},!0);function r(l,i){if(i==null)return[""];switch(i.type.type){case"object":{let s=i.getMembers().flatMap(d=>r(l+1,d));return l==1?s:["{ ",...s," }"]}case"array":{let s=i.entryBoxes.getValue().filter(d=>d!=null).flatMap(d=>r(l+1,d));return l==1?s:["[ ",...s," ]"]}case"variant":{let o=i.getValue();return[t("small",{class:"form-span-label"},String(o.type)+": "),t("span",{class:"form-span-content"},o.value)]}default:{let o=i.getValue();return o=String(o),o.length==0?[""]:(o.length>40&&(o=o.slice(0,37)+"..."),[t("small",{class:"form-span-label"},i.name+": "),t("span",{class:"form-span-content"},o)])}}}return t(T,null,a)}getTypeDefaultValue(n){switch(n=this.getActualType(n),n.type){case"string":return n.defaultValue??"";case"number":return n.defaultValue??0;case"boolean":return n.defaultValue??!1;case"object":let a={};return n.membersTypes.forEach(l=>{a[l.key]=this.getTypeDefaultValue(l)}),a;case"array":return[];case"variant":let r=n.variants[0];return{key:r.key,value:this.getTypeDefaultValue(r)};case"const":return;case"date":case"time":case"datetime":return"";default:throw Error("Unexpected type "+n.type)}return null}}class Ue{constructor(n){this.box=n,this.sortOrders=new x("arraySortOrders",[]),this.filters=new x("arrayFilters",[]),this.columns=void 0,this._filteredValues=void 0,this._sortedValues=void 0,this.entryBoxes=n.entryBoxes;let a=this.box.type.entryType;this.columns=a&&a.type=="object"?a.membersTypes.map((r,l)=>({key:r.key??"",label:r.key,memberIndex:l})):[{key:"#value",label:"Value"}]}newArrayEntry(){return this.box.type.entryType,this.box.getDefaultValue()}addValue(){let a=[...this.box.getValue(),this.newArrayEntry()];this.box.setValue(a)}deleteValue(n){let a=this.box.getValue();a.splice(n,1),this.box.setValue(a)}toggleSort(n,a,r){je(r);let l=this.sortOrders.getValue();const i=l.find(s=>s.column.key===n);let o;i?i.direction==="asc"?o=l.map(s=>s.column.key===n?{...s,direction:"desc"}:s):o=r.ctrlKey?l.filter(s=>s.column.key!==n):[]:o=r.ctrlKey?[...l,{column:this.columns[a],direction:"asc"}]:[{column:this.columns[a],direction:"asc"}],console.log(JSON.stringify(o)),this.sortOrders.setValue(o)}updateFilter(n,a){const r=[...this.filters.getValue()];r[n]=a.toLowerCase(),this.filters.setValue(r)}get filteredValues(){return this._filteredValues??(this._filteredValues=v("arrayFilteredValues",{entries:this.entryBoxes,filters:this.filters},n=>{const a=[...n.entries],r=n.filters;return a.filter(i=>(i instanceof C&&(i=C.unBox(i)),this.columns.every((o,s)=>{const d=r[s];if(!d)return!0;const y=o.key?i[o.key]:i;return y==null?d=="null":String(y).toLowerCase().includes(d)})))}))}get sortedValues(){return this._sortedValues??(this._sortedValues=v("arraySortedValues",{filteredValues:this.filteredValues,sortOrder:this.sortOrders},n=>{const a=n.filteredValues,r=n.sortOrder;return a.sort((l,i)=>{let o=l instanceof C?C.unBox(l):l,s=i instanceof C?C.unBox(i):i;for(const d of r){const y=d.column.key;let c=0;if(o&&typeof o=="object"&&s&&typeof s=="object"&&(o=o[y],s=s[y]),typeof o=="number"&&typeof s=="number"?c=o-s:typeof o=="boolean"&&typeof s=="boolean"?c=o===s?0:o?1:-1:(o=o==null?"":String(o),s=s==null?"":String(s),c=o.localeCompare(s)),c!==0)return d.direction==="desc"?-c:c}return l instanceof C&&i instanceof C?l.uniqueId-i.uniqueId:0}),[...a]}))}sortSuffix(n){if(!n)return"";let a=this.sortOrders.getValue();const r=a.findIndex(l=>l.column.key===n);return r>=0?(a[r].direction==="asc"?"▲":"▼")+(r>0?String(r+1):""):""}}A.add("th.table-title",{cursor:"pointer "});function Xe(e){let n=e.box.type.view,a=new Ue(e.box),l={table:j,tabs:u,carousel:h,list:V,flow:L,popup:F}[n==null?void 0:n.type]||L,i=e.box.entryBoxes,o=v("BootstrapArrayView.currentPageBoxes",{$entryBoxes:e.box.entryBoxes,pageNo:e.engine.pageNo,rePaginationCount:e.engine.rePaginationCount},m=>e.box.entryBoxes.getValue().filter(w=>e.engine.isBoxVisible(w)));function s(){e.engine.InputTop(e)}function d(){e.engine.InputBottom(e)}function y(){let m=e.box.type.entryType;return e.engine.getTypeDefaultValue(m)}function c(){return e.engine.isReadonly?t(T,null):t("button",{class:"btn btn-sm btn-secondary mt-2",onClick:()=>{let w=[...e.box.getValue(),y()];e.box.setValue(w),e.box.paginate()}},"Add")}function b(m){return e.engine.isReadonly?t(T,null):t("button",{class:"btn btn-sm btn-secondary mt-2",onClick:()=>{let w=e.box.getValue();w.splice(m,1),e.box.setValue(w)}},"Delete")}function p(m,w){let k=f.length==1&&f[0].key==="#value";return t("div",null,t("label",null,m.name),k?e.engine.InputRenderer({engine:e.engine,label:e.label,level:e.level+1,box:m}):t(S,{each:f},(D,z)=>B(m,w,D,z)),b(w))}let f=[],g=e.box.type.entryType;g&&g.type=="object"?f=g.membersTypes.map((m,w)=>({key:m.key??"",label:m.key,memberIndex:w})):f=[{key:"#value",label:"Value"}];function B(m,w,k,D){return e.engine.InputRenderer({engine:e.engine,label:k.label,level:e.level,box:m instanceof be?m.members[D]:m})}function I(m){return t("tr",null,t(S,{each:f},(w,k)=>t("td",null,B(m.entry,m.index,w,k))),t("td",null,b(m.index)))}function j(){var m;return t(T,null,t("label",null,e.label),s(),t("table",null,t("thead",null,t(O,{when:((m=f[0])==null?void 0:m.key)!="#value"},v("tableLabels",{sortOrder:a.sortOrders},w=>t("tr",null,t(S,{each:f},(k,D)=>t("th",{class:"table-title",onMouseDown:z=>a.toggleSort(k.key,D,z)},k.key,a.sortSuffix(k.key))),t("th",null," ")))),t("tr",null,t(S,{each:f},(w,k)=>t("th",null,t("input",{type:"text",placeholder:"Filter",style:{width:"100%"},onInput:D=>a.updateFilter(k,D.target.value)}))),t("th",null," "))),t("tbody",null,v("BootstrapArrayVIew.pageContent",{pageNo:e.engine.pageNo},w=>t(S,{each:a.sortedValues},(k,D)=>t(I,{...e,entry:k,index:D}))))),c(),d())}function F(){return t(T,null,s(),t("div",{class:"list-group"},t(S,{each:o},(m,w)=>{let k=new x("popupIsOpen",!1);return t("div",{class:"list-group-item list-group-item-action d-flex align-items-center",onClick:()=>k.setValue(!0)},t("span",null,"#",String(w+1)," ",e.engine.Span(m)),t(e.engine.PopupButton,{visible:k,button:t("span",null)},p==null?void 0:p(m,w)))})),c(),d())}function L(){return t(T,null,t("div",{class:"card p-3"},s(),t(S,{each:o},(m,w)=>t("div",{class:"flow-item"},p==null?void 0:p(m,w))),c(),d()))}function u(){const m=new x("tabsActiveTab",0);return t(T,null,t("div",{class:"tabs-container"},t("ul",{class:"nav nav-tabs"},t(S,{each:o},(w,k)=>t("li",{class:"nav-item"},t("button",{class:v("tabsHeader#"+k,{activeTab:m},D=>`nav-link ${k===D.activeTab?"active":""}`),onClick:()=>m.setValue(k)},k+1)))),t("div",{class:"tab-content mt-3"},t(S,{each:o},(w,k)=>t("div",{class:v("tabsPanel#"+k,{activeTab:m},D=>`tab-pane fade ${k===D.activeTab?"show active":""}`)},p(w,k))))),d(),c())}function h(){const m=new x("carouselActiveIndex",0),w=i.getValue().length,k=e.box.type.view||{},D=k.autoplay!==void 0?k.autoplay:!0,z=k.interval??3e3;return D&&w>0&&setInterval(()=>{m.setValue((m.getValue()+1)%w)},z),t(T,null,s(),t("div",{id:"carouselExample",class:"carousel slide","data-bs-ride":"carousel"},t("div",{class:"carousel-indicators"},t(S,{each:i},(ce,_)=>t("button",{type:"button",class:v("carouselClass",{activeIndex:m},q=>_===q.activeIndex?"active":""),"aria-current":v("carouselAriaCurrent",{activeIndex:m},q=>_===q.activeIndex?"true":"false"),"aria-label":`Slide ${_+1}`,onClick:()=>m.setValue(_)}))),t("div",{class:"carousel-inner"},t(S,{each:i},(ce,_)=>t("div",{class:v("carouselInner",{activeIndex:m},q=>`carousel-item ${_===q.activeIndex?"active":""}`)},p(ce,_)))),t("button",{class:"carousel-control-prev",type:"button",onClick:()=>m.setValue((m.getValue()-1+w)%w)},t("span",{class:"carousel-control-prev-icon","aria-hidden":"true"}),t("span",{class:"visually-hidden"},"Previous")),t("button",{class:"carousel-control-next",type:"button",onClick:()=>m.setValue((m.getValue()+1)%w)},t("span",{class:"carousel-control-next-icon","aria-hidden":"true"}),t("span",{class:"visually-hidden"},"Next"))),d(),c())}function V(){return t(T,null,"todo")}return l()}A.add(".form-control.for-checkbox.form-switch",{"padding-left":"50px"});A.add(".form-control.for-checkbox:focus-within",{"border-color":"var(--bs-primary)","box-shadow":"0 0 0 0.25rem rgba(var(--bs-primary-rgb), 0.25)"});A.add(".form-control.for-checkbox > .form-check-input:focus",{"box-shadow":"unset"});A.add(".form-check-input:indeterminate",{"background-position-x":"center","background-color":"var(--bs-warning) !important","border-color":"var(--bs-warning)  !important"});function We(e){let n=e.box.type;const a=()=>{var c;return((c=n==null?void 0:n.view)==null?void 0:c.type)==="switch"},r=()=>{var c,b;return((c=n==null?void 0:n.view)==null?void 0:c.type)==="popup"||((b=n.view)==null?void 0:b.popup)};let l=$(`bool_${e.label}`),i;function o(c){i=c,i.indeterminate=e.box.getValue()===null}function s(){let c=new x("popupButtonPopupVisible",!1),{PopupButton:b,Span:p}=e.engine;return t(T,null,t("div",{class:"row"},t("div",{class:"col-auto"},t(b,{visible:c},d)),t("div",{class:"col"},p(e.box))))}function d(){return t(T,null,t(e.engine.InputTop,{...e}),t("div",{class:`d-flex flex-column form-control for-checkbox position-relative ${a()?"form-switch":""}`,onMouseDown:c=>{c.preventDefault(),i==null||i.focus()}},t("div",{class:"d-flex flex-row"},t("input",{tabindex:"0",type:"checkbox",ref:o,class:"form-check-input",id:l,checked:v("bool",{value:e.box},c=>c.value===!0),readOnly:e.engine.isReadonly,onBlur:c=>y(c),onChange:c=>{y(c)}}),t("label",{class:"form-check-label ms-2 flex-grow-1","x-onMouseDown":c=>{c.preventDefault(),i==null||i.focus()}},e.label)),t(e.engine.InputBottom,{...e})))}if(r())return s();return d();function y(c){const b=c.currentTarget.checked;e.box.setValue(b,{notify:!0,validate:!0})}}function Q(e){var y;let n=$(`date_${e.label}`);const a=new x("bootstrapDateIsFocused",!1),r=(y=e.box.type.view)==null?void 0:y.suffix,l=v("BootstrapDateView.inputType",{isFocused:a},c=>{if(!c.isFocused)return"string";switch(e.box.type.type){case"time":return"time";case"datetime":return"datetime-local";case"date":default:return"date"}});function i(c){const b=new Date("9999-12-31T23:59:59");return c instanceof Date&&!isNaN(c.getTime())&&c<=b}function o(){let c=e.box.getValue(),b=e.box.type.type,p=new Date(Date.parse(b==="time"?"1970-01-01T"+c:c));return i(p)?s(p):""}function s(c){switch(e.box.type.type){case"time":return c.toISOString().split("T")[1].substring(0,8);case"datetime":return c.toISOString().slice(0,16);case"date":default:return c.toISOString().split("T")[0]}}return t(T,null,e.engine.InputTop(e),t("div",{class:"input-group mb-3"},t("div",{class:"form-floating"},t("input",{type:l,id:n,class:"form-control",value:v("box",{box:e.box},c=>o()),readOnly:v("BootstrapDateView.readonly",{isFocused:a},c=>e.engine.isReadonly||!c.isFocused),placeholder:"",onFocus:c=>{a.setValue(!0),setTimeout(()=>{let b=c.target;b&&(b.value=String(e.box.getValue()),b.select())})},onBlur:c=>{a.setValue(!1),setTimeout(()=>{let b=c.target;b&&(b.value=o())}),d(c)},onInput:c=>{a.getValue()&&d(c)}}),t("label",{for:n,class:"form-label"},e.label)),t(O,{when:r},t("span",{class:"input-group-text",id:"basic-addon2"},r))),e.engine.InputBottom(e));function d(c){let b=c.currentTarget,p=b.valueAsDate??new Date(b.value);i(p)?e.box.setValue(s(p),{notify:!0,validate:!0}):b.value==""&&e.box.setValue(null,{notify:!0,validate:!0})}}A.add(".buttons.btn:focus",{border:"1px solid #ccc"});new x("currentModals",[]);const He=e=>{let n=t("div",{class:"container"},e.header,e.engine.InputRenderer({engine:e.engine,label:e.form.dataType.label??e.form.name,level:1,box:e.box}),e.footer);return e.engine.paginate(e.box),n};function oe(e){return e.engine.pageNo,t("main",null,t(He,{engine:e.engine,form:e.form,box:e.box,header:t("h1",null,e.form.name),footer:t(T,null)}))}A.add("input.number-input",{textAlign:"right"});A.add('input.number-input[type="string"]',{paddingRight:"27px !important"});A.add('input.form-range[type="range"]',{"-webkit-appearance":"auto","-moz-appearance":"auto",appearance:"auto"});function Ge(e){var p;let n=$(`num_${e.label}`);const a=new x("bootstrapNumberIsFocused",!1),r=(p=e.box.type.view)==null?void 0:p.suffix,l=()=>{var f;return((f=e.box.type.view)==null?void 0:f.type)==="slider"},i=()=>{var f;return((f=e.box.type.view)==null?void 0:f.type)==="popup"};function o(){let f=e.box.getValue(),g;switch(typeof f){case"number":g=f;break;default:g=s(String(f));break}return g==null?"":new Intl.NumberFormat("fr-FR",{minimumFractionDigits:e.box.type.decimals??0}).format(g)}const s=f=>{let g=parseFloat(f.replace(/,/g,""));return isNaN(g)?null:g};function d(){let f=new x("popupButtonPopupVisible",!1),{PopupButton:g,Span:B}=e.engine;return t("div",{class:"row"},t("div",{class:"col-auto"},t(g,{visible:f},y)),t("div",{class:"col"},B(e.box)))}function y(){return t(T,null,e.engine.InputTop(e),t("div",{class:"input-group mb-3"},t("div",{class:"form-floating"},t("input",{"x-test":a,type:v("BootstrapNumber.type",{isFocused:a},f=>f.isFocused?"number":"string"),id:n,class:"form-control number-input",value:v("box",{value:e.box},f=>o()),readOnly:v("BootstrapNumber.readonly",{isFocused:a},f=>e.engine.isReadonly||!a.getValue()),placeholder:"",onFocus:f=>{a.getValue()||(a.setValue(!0),setTimeout(()=>{let g=f.target;g&&(g.value=String(e.box.getValue()),g.select())}))},onBlur:f=>{a.setValue(!1),setTimeout(()=>{let g=f.target;g&&(g.value=o())}),b(f)},onInput:f=>{a.getValue()&&b(f)}}),t("label",{for:n,class:"form-label"},e.label)),t(O,{when:r},t("span",{class:"input-group-text",id:"basic-addon2"},r))),e.engine.InputBottom(e))}function c(){var F,L,u,h;const f=((F=e.box.type.view)==null?void 0:F.min)??0,g=((L=e.box.type.view)==null?void 0:L.max)??10,B=((u=e.box.type.view)==null?void 0:u.step)??1,I=((h=e.box.type.view)==null?void 0:h.tickmarks)??!1;let j=I?$("marks"):void 0;return t(T,null,e.engine.InputTop(e),t("div",{class:"mb-3"},t("label",{for:n,class:"form-label"},e.label),t("input",{id:n,type:"range",class:"form-range",min:f,max:g,step:B,list:j,value:v("rangeValue",{value:e.box},V=>V.value),onInput:V=>{const m=s(V.currentTarget.value)??0;e.box.setValue(m,{notify:!0,validate:!0})}}),t(O,{when:I},t("datalist",{id:j},Array.from({length:Math.floor((g-f)/B)+1},(V,m)=>{const w=f+m*B;return t("option",{value:w})})))),e.engine.InputBottom(e))}if(l())return c();return i()?d():y();function b(f){e.box.setValue(s(f.currentTarget.value),{notify:!0,validate:!0})}}function ge(e){switch(e.view){case"html":return t("div",{innerHTML:e.value})}return t(T,null,"TODO")}function Ye(e){const n={popup:d,tabs:o,wizard:s,default:b};let a=e.box.type.view,r=n[a==null?void 0:a.type]||b,l=e.box.getMembers();function i(p,f){return e.engine.InputRenderer({engine:e.engine,label:p.type.label??p.name,box:p,level:e.level+1})}function o(){const p=new x("tabActiveTab",0);return t(T,null,t("div",{class:"tabs-container"},t("ul",{class:"nav nav-tabs"},t(S,{each:l},(f,g)=>t("li",{class:"nav-item"},t("button",{class:v("Tabs.Button",{activeTab:p},B=>`nav-link ${g===B.activeTab?"active":""}`),onClick:()=>p.setValue(g)},()=>f.type.label||f.type.key)))),t("div",{class:"tab-content mt-3"},t(S,{each:l},(f,g)=>t("div",{class:v("Tabs.Panel",{activeTab:p},B=>`tab-pane fade ${g===B.activeTab?"show active":""}`)},i(f))))),c())}function s(p={}){const f=new x("wizardActiveStep",0);function g(I){I>=l.length-1?p.onClosed&&(f.setValue(0),p.onClosed()):f.setValue(I+1)}function B(I){I>0&&f.setValue(I-1)}return t(T,null,t("div",{id:"wizardCarousel",class:"carousel slide","data-bs-ride":"false"},t("div",{class:"carousel-indicators"},t(S,{each:l},(I,j)=>t("button",{type:"button","data-bs-target":"#wizardCarousel",class:v("Wizard.carouselButtonClass",{activeStep:f},F=>{j<=F.activeStep}),disabled:!0}))),t("div",{class:"carousel-inner"},t(S,{each:l},(I,j)=>t("div",{class:v("Wizard.carouselContentClass",{activeStep:f},F=>`carousel-item ${j===F.activeStep?"active":""}`)},i(I),t("div",{class:"d-flex justify-content-between mt-3"},t("button",{class:"btn btn-secondary",disabled:j===0,onClick:()=>B(j)},"Précédent"),t("button",{class:"btn btn-primary",onClick:()=>g(j)},"Suivant")))))))}function d(){let p=new x("popupButtonPopupVisible",!1),{PopupButton:f,Span:g}=e.engine;return t(T,null,t("div",{class:"row"},t("div",{class:"col-auto"},t(f,{visible:p},r)),t("div",{class:"col"},g(e.box))))}function y(){return e.engine.InputTop(e)}function c(){return e.engine.InputBottom(e)}function b(){return t(T,null,t("div",{class:"card p-3"},y(),t("p",null,e.label??e.box.type.label),t(S,{each:l},(p,f)=>p.type.type=="const"?t(ge,{...p.type}):t("div",{class:"mb-2 object-members"},t("label",{class:"form-label"},p.key),e.engine.InputRenderer({engine:e.engine,label:p.type.label??p.name,box:p,level:e.level+1}))),c()))}return typeof a=="object"&&"popup"in a&&a.popup?d:r}function he(e){var o;let n=$("single_selection"),a;function r(s){a||(a=new te.Dropdown(document.getElementById(n),{autoClose:!0})),a.toggle()}let l=e.selectedKey.getValue();switch(e.entries.findIndex(s=>s.value==l)<0&&(l=String((o=e.entries[0])==null?void 0:o.value),e.selectedKey.setValue(l)),e.view.type){case"radiobuttons":let s=e.view;return t("div",{class:`single-selection ${s.type} ${s.class}`},t("label",{class:"pe-1"},e.label),t("div",{id:n,class:"selection-entries row"},t(S,{each:e.entries},d=>t("div",{class:`selection-entry ${s.itemClass??""}`},t("div",{class:"form-check"},t("input",{class:"form-check-input",type:"radio",name:n,id:`${n}-${d.value}`,value:String(d.value),checked:d.value===l,onInput:()=>e.selectedKey.setValue(d.value)}),t("label",{class:"form-check-label",for:`${n}-${d.value}`},d.label||String(d.value)))))));case"select":return t("div",{class:"form-floating"},t("select",{class:"form-select",id:n,onInput:d=>e.selectedKey.setValue(d.target.value)},t(S,{each:e.entries??[]},d=>t("option",{value:String(d.value),selected:d.value===l},d.label||String(d.value)))),t("label",{for:n},e.label));case"dropdown":default:return t("div",{class:"dropdown","x-data-bs-toggle":"dropdown","aria-haspopup":"true"},t("label",{class:"pe-1"},e.label),t("button",{class:"btn btn-secondary dropdown-toggle btn-sm",type:"button",id:n,"aria-expanded":"false",onClick:r},v("SingleSelectionVue.buttonText",{selectedKey:e.selectedKey},d=>{var y;return((y=(e.entries??[]).find(c=>c.value===d.selectedKey))==null?void 0:y.label)||e.selectedKey})),t("ul",{class:"dropdown-menu","aria-labelledby":n},t(S,{each:e.entries??[]},d=>t("li",null,t("button",{class:"dropdown-item",type:"button",onClick:()=>{a==null||a.hide(),e.selectedKey.setValue(d.value)}},d.label||String(d.value))))))}}function Ze(e){let n=$("checkbox-group");const a=v("MultipleSelectionVue.Set",{},()=>new Set(e.selectedKeys));function r(l,i){let o=e.entries.map(s=>String(s.value)).filter(s=>s===l?i.checked:a.getValue().has(String(s)));e.setSelectedKeys(o)}return formulaireBleuJSX("div",{class:"multiple-selection"},formulaireBleuJSX("label",{class:"pe-1"},e.label),formulaireBleuJSX("div",{id:n,class:"d-flex flex-column"},formulaireBleuJSX(S,{each:e.entries},l=>formulaireBleuJSX("div",{class:"form-check"},formulaireBleuJSX("input",{class:"form-check-input",type:"checkbox",id:`${n}-${l.value}`,value:String(l.value),checked:a.getValue().has(String(l.value)),onInput:i=>r(String(l.value),i.target)}),formulaireBleuJSX("label",{class:"form-check-label",for:`${n}-${l.value}`},l.label||String(l.value))))))}function fe(e){let n=e.box.type.selectionList??e.box.type.view.selectionList;if(!n)return t(M,{error:"Internal Error, no selection list set."});if(!Array.isArray(n.entries))return t(M,{error:"dynamic-selection is not implemented yet."});let a=n.entries;if(a){if(a.length==0)return t(M,{error:"Empty selection list."})}else return t(M,{error:"Internal Error, no selection entries set."});let r=e.box.type.selectionList??e.box.type.view;if(n.multiple){let l=function(i){e.box.setValue(i,{validate:!1})};return r||(r={type:"checkboxes"}),t(Ze,{label:e.label,entries:a,selectedKeys:e.box.getValue(),setSelectedKeys:l,view:r})}else return r||(r={type:"dropdown"}),t(he,{label:e.label,entries:a,selectedKey:e.box,view:r})}let Qe={9:/[0-9]/,a:/[a-zA-Z]/,"*":/./};const et=(e,n,a)=>{let r="",l=0,i=0,o=!1;for(;l<n.length;){let s=n[l],d=e[i],y=Qe[s];if(y?(d&&y.test(d)&&(r+=d,l+=1),i+=1):(r+=s,l+=1,d==s?i+=1:l<=a+1&&(o=!0)),d===void 0)break}return{newValue:r,newPos:a+(o?1:0)}};function tt(e){var s,d;let n=$(`txt_${e.label}`);const a=new x("stringViewIsFocused",!1);let r=(s=e.box.type.view)==null?void 0:s.mask;function l(){let y=new x("popupButtonPopupVisible",!1),{PopupButton:c,Span:b}=e.engine;return t(T,null,t("div",{class:"row"},t("div",{class:"col-auto"},t(c,{visible:y},i)),t("div",{class:"col"},b(e.box))))}function i(){return t(T,null,e.engine.InputTop(e),t("div",{class:"form-floating"},t("input",{type:v("BootstrapStringView.type",{isFocused:a},y=>y.isFocused?"text":"string"),id:n,class:"form-control",value:e.box,readOnly:v("BootstrapStringView.readonly",{isFocused:a},y=>e.engine.isReadonly||!y.isFocused),placeholder:"",required:e.box.type.mandatory,onFocus:y=>{a.getValue()||a.setValue(!0)},onBlur:y=>{a.setValue(!1),o(y)},onInput:y=>{a.getValue()&&o(y)}}),t("label",{for:n,class:"form-label"},e.label)),e.engine.InputBottom(e))}if(((d=e.box.type.view)==null?void 0:d.type)==="popup")return l();return i();function o(y){let c=y.currentTarget,b=e.box.getValue(),p=c.value,f=c.selectionStart??p.length,g=r?et(p,r,f):void 0;if(g){let B=g.newValue;B!==p&&(B===b&&p.length<b.length||(c.value=B,setTimeout(()=>c.selectionStart=c.selectionEnd=g.newPos),p=B))}e.box.setValue(p,{notify:!0,validate:!0})}}function nt(e){const n=v("BootstrapVariantView.comp",{box:e.box.variantInnerBox},r=>r.box?e.engine.InputRenderer({engine:e.engine,label:e.label,level:e.level,box:r.box}):t("p",null,"no box"));let a=e.box.getVariants().map((r,l)=>({value:r.key,label:r.label??r.key??"#"+(l+1)}));return t(T,null,e.engine.InputTop(e),t(he,{view:{type:"dropdown"},selectedKey:e.box.typeKey,entries:a,label:"View as:"}),n,e.engine.InputBottom(e))}function at(e){return formulaireBleuJSX(ge,{...e.box.type.view})}var te;class se extends qe{constructor(n,a=!0){super(n),a&&this.ensureBootstrapLoaded()}FormView(n){let a=this;return r(),t(oe,{engine:a,...n});function r(){let l=n.form.templates;if(l)for(let i of Object.keys(l))a.templates[i]=l[i]}}getRenderer(n){var i;let a=this.getActualType(n),r={string:tt,boolean:We,number:Ge,array:Xe,object:Ye,variant:nt,selectionList:fe,select:fe,date:Q,time:Q,datetime:Q,void:at},l=r[((i=a.view)==null?void 0:i.type)??"undefined"]??r[a.type??"undefined"];return l||(()=>t(M,{error:`Form type  ${JSON.stringify(a.type??null)} is unknown`}))}ensureBootstrapLoaded(){function n(){const r=document.createElement("div");r.className="container",document.body.appendChild(r);const l=window.getComputedStyle(r).marginLeft!=="0px";return document.body.removeChild(r),l}function a(){let r=window.bootstrap;return r&&(te=r),typeof r<"u"}if(!n()){const r=document.createElement("link");r.href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css",r.rel="stylesheet",r.integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH",r.crossOrigin="anonymous",document.head.appendChild(r)}if(!a()){const r=document.createElement("script");r.src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js",r.integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz",r.crossOrigin="anonymous",r.defer=!0,document.body.appendChild(r),r.onload=l=>setTimeout(()=>{console.log("loaded"),te=window.bootstrap})}console.log("Bootstrap loaded")}PopupButton(n,a){let r=n.visible??new x("popupButtonIsOpen",!1),l=n.button??t("button",{class:"btn btn-primary",onClick:()=>{r.setValue(!0)}},"…");function i(){return n.validate&&!n.validate()?!1:(r.setValue(!1),!0)}function o(d){d.target===d.currentTarget&&i()&&d.stopPropagation()}let s=new x("popupButtonModalBody");return r.addObserver(d=>{d&&setTimeout(()=>{let y=s.getValue(),c=y==null?void 0:y.querySelector("input, textarea, button");c==null||c.focus(),typeof c.select=="function"&&(c==null||c.select())})}),t(T,null,t(O,{when:r,fallback:l},t("div",{class:v("PopupButton.class",{isOpen:r},d=>`modal fade ${d.isOpen?"show d-block":""}`),tabindex:"-1",onClick:o},t("div",{class:"modal-dialog"},t("div",{class:"modal-content"},t(O,{when:n.header},t("div",{class:"modal-header"},t("h5",{class:"modal-title"},n.header),n.closeable!=!1&&t("button",{type:"button",class:"btn-close",onClick:i}))),t("div",{class:"modal-body",ref:s},a),t(O,{when:n.footer},t("div",{class:"modal-footer"},n.footer)))))),v("PopupButton.backDrop",{isOpen:r},d=>d.isOpen?t("div",{class:"modal-backdrop fade show"}):null))}}A.add("div.section",{marginBottom:"2em"});A.add("div.form-comp",{paddingLeft:"4em"});A.add("pre.output",{marginTop:"0.5em"});A.add("textarea.form-schema-editor",{fontFamily:"monospace"});const it={type:"section",title:"Formulaire Bleu - Test Suite",description:"A comprehensive test suite for Formulaire Bleu, covering all supported data types, validations, and input styles.",content:[{type:"section",title:"Basic Types",description:"This section covers the fundamental JSON data types: strings, numbers, and booleans. These are the building blocks of any form.",content:[{type:"section",title:"String Type",description:"String inputs allow users to enter text values. Additional options include default values, validation rules, and dropdown selections.",content:[{type:"form",form:{version:"1",name:"Basic String",dataType:{type:"string",help:"A simple text input without constraints."}}},{type:"form",form:{version:"1",name:"String with Default",dataType:{type:"string",help:'Pre-filled with "A".',defaultValue:"A"}}},{type:"form",form:{version:"1",name:"Required String",dataType:{type:"string",validations:{mandatory:!0},help:"User must enter a value before leaving the field."}}},{type:"form",form:{version:"1",name:"Regex Validation",dataType:{type:"string",validations:{regex:[{regex:"^[0-7-]+$",message:"Only digits 0-7 and dashes are allowed."}],minLength:3,maxLength:10},help:"Text input restricted to octal digits (0-7) and dashes."}}},{type:"form",form:{version:"1",name:"Dropdown Selection",dataType:{type:"string",help:"Select a predefined option from a dropdown menu.",view:{type:"select",selectionList:{entries:[{label:"Small",value:"SM"},{label:"Medium",value:"MD"},{label:"Large",value:"LG"}]}}}}},{type:"form",form:{version:"1",name:"Popup Input",dataType:{type:"string",help:"Text input shown in a popup for better focus.",view:{type:"popup"}}}}]},{type:"section",title:"Number Type",description:"Number inputs allow users to enter numerical values, including sliders and required fields.",content:[{type:"form",form:{version:"1",name:"Basic Number",dataType:{type:"number",help:"A simple numeric input."}}},{type:"form",form:{version:"1",name:"Number with Default",dataType:{type:"number",help:"Pre-filled with 1.",defaultValue:1}}},{type:"form",form:{version:"1",name:"Number Slider",dataType:{type:"number",help:"Slider input with tick marks for better selection.",view:{type:"slider",tickmarks:!0}}}},{type:"form",form:{version:"1",name:"Required Number",dataType:{type:"number",validations:{mandatory:!0},help:"User must enter a number before submitting."}}},{type:"form",form:{version:"1",name:"Popup Number",dataType:{type:"number",help:"Number input displayed in a popup for better focus.",view:{type:"popup"}}}}]},{type:"section",title:"Boolean Type",description:"Boolean inputs represent true/false values and can be displayed as checkboxes or switches.",content:[{type:"form",form:{version:"1",name:"Basic Boolean",dataType:{type:"boolean",help:"A simple checkbox input for true/false values."}}},{type:"form",form:{version:"1",name:"Boolean with Default",dataType:{type:"boolean",help:'Pre-filled with "true".',defaultValue:!0}}},{type:"form",form:{version:"1",name:"Required Boolean",dataType:{type:"boolean",validations:{mandatory:!0},help:"User must select an option before proceeding."}}},{type:"form",form:{version:"1",name:"Boolean Switch",dataType:{type:"boolean",help:"Displayed as an ON/OFF switch for better UX.",view:{type:"switch"}}}},{type:"form",form:{version:"1",name:"Popup Boolean",dataType:{type:"boolean",help:"Boolean selection inside a popup.",view:{type:"popup"}}}},{type:"form",form:{version:"1",name:"Switch in Popup",dataType:{type:"boolean",help:"Switch control inside a popup for better visibility.",view:{type:"switch",popup:!0}}}}]}]},{type:"section",title:"Other Types",description:"This section covers date, time, datetime and location type. While not JSON these common type are in the core package for any form.",content:[{type:"section",title:"Date and time types",description:"String inputs allow users to enter text values. Additional options include default values, validation rules, and dropdown selections.",content:[{type:"form",form:{version:"1",name:"Simple date",dataType:{type:"date"}}},{type:"form",form:{version:"1",name:"Simple time",dataType:{type:"time"}}},{type:"form",form:{version:"1",name:"Simple datetime",dataType:{type:"datetime"}}}]},{type:"section",title:"Location Type",description:"A location on the map.",content:[{type:"form",form:{version:"1",name:"TODO",dataType:{type:"number",help:"TODO"}}}]}]},{type:"section",title:"Arrays",description:"Arrays allow users to enter multiple values of the same type, such as a list of numbers, strings or any other type.",content:[{type:"form",form:{version:"1",name:"String Array",dataType:{type:"array",entryType:{type:"string"},help:"A list of text values."}}},{type:"form",form:{version:"1",name:"Number Array",dataType:{type:"array",entryType:{type:"number"},help:"A list of numeric values."}}},{type:"form",form:{version:"1",name:"Boolean Array",dataType:{type:"array",entryType:{type:"boolean"},help:"A list of true/false values."}}},{type:"form",form:{version:"1",name:"Object Array",dataType:{type:"array",entryType:{type:"object",membersTypes:[{key:"name",type:"string"},{key:"dob",type:"date"}]},help:"A list of person."}}},{type:"form",form:{version:"1",name:"Object Array with table view",dataType:{type:"array",view:{type:"table"},entryType:{type:"object",membersTypes:[{key:"name",type:"string"},{key:"dob",type:"date"}]},help:"A list of person."}}},{type:"form",form:{version:"1",name:"Object Array with popup view",dataType:{type:"array",view:{type:"popup"},entryType:{type:"object",membersTypes:[{key:"name",type:"string"},{key:"dob",type:"date"}]},help:"A list of person."}}},{type:"form",form:{version:"1",name:"Object Array with tabs view",dataType:{type:"array",view:{type:"tabs"},entryType:{type:"object",membersTypes:[{key:"name",type:"string"},{key:"dob",type:"date"}]},help:"A list of person."}}},{type:"form",form:{version:"1",name:"Object Array with popup and button view",dataType:{type:"array",view:{type:"popup",buttons:"OKCancel"},entryType:{type:"object",membersTypes:[{key:"name",type:"string"},{key:"dob",type:"date"}]},help:"A list of person."}}},{type:"form",form:{version:"1",name:"Variant Array",dataType:{type:"array",view:{type:"popup",buttons:"OKCancel"},entryType:{type:"variant",variants:[{key:"name",type:"string"},{key:"dob",type:"date"}]},help:"A list of either name or dob."}}}]},{type:"section",title:"Objects",description:"Objects contain multiple fields of different types, allowing for complex data structures.",content:[{type:"form",form:{version:"1",name:"Object Form",dataType:{type:"object",membersTypes:[{key:"str",type:"string"},{key:"innerObject",type:"object",membersTypes:[{key:"last",type:"string"}],help:"A structured object containing multiple fields with different data types."}],help:"A structured object containing multiple fields with different data types."}}}]},{type:"section",title:"Variants",description:"Variant types allow a field to take different types at different times, enforcing mutually exclusive options.",content:[{type:"form",form:{version:"1",name:"Variant Form",dataType:{type:"variant",variants:[{key:"str",type:"string"},{key:"num",type:"number"},{key:"bool1",type:"boolean"},{key:"boolIn",type:"object",membersTypes:[{key:"v",type:"boolean",view:{type:"switch"}}]},{key:"obj",type:"object",membersTypes:[{key:"firstname",type:"string"},{key:"lastname",type:"string"},{key:"dog",type:"const",value:"k9"}]}],help:"A field that can take only one type at a time, ensuring valid input."}}},{type:"form",form:{version:"1",name:"Flat Variant Form",dataType:{flat:!0,type:"variant",variants:[{key:"str",type:"string"},{key:"num",type:"number"},{key:"obj",type:"object",membersTypes:[{key:"firstname",type:"string"},{key:"lastname",type:"string"},{key:"dog",type:"const",value:"k9"}]}],help:"A field that can take only one type at a time, ensuring valid input."}}},{type:"form",form:{version:"1",name:"Flat Variant with determinant Form",dataType:{flat:!0,determinant:"type",type:"variant",variants:[{key:"car",type:"object",membersTypes:[{key:"hybrid",type:"boolean"}]},{key:"man",type:"object",membersTypes:[{key:"firstname",type:"string"}]}],help:"A field that can take only one type at a time, ensuring valid input."}}}]}]};function rt(e){let n=new x("isValid",!0),a=new x("source","");return e.jsonValue.addObserver(l=>{let i=JSON.stringify(l,void 0,"   ");a.setValue(i)}),t("div",{class:"container mt-3"},t("label",{for:"exampleTextarea",class:"form-label"},"Form data"),t("textarea",{class:v("isValid",{isValid:n},l=>"form-control form-schema-editor"+(l.isValid?"":" is-invalid")),placeholder:"Source",style:e.style,onInput:r,value:a}),t("div",{class:"invalid-feedback"},"Invalid JSON Value"));function r(l){try{let i=l.target,o=JSON.parse(i.value);JSON.stringify(e.jsonValue.getValue())!=JSON.stringify(o)&&e.jsonValue.setValue(o,{notify:!0}),n.setValue(!0)}catch{n.setValue(!1)}}}function ve(e){var n=new x("jsonValue",{});return e.box.addChildChangedObserver(a=>{let r=e.box.getValue();n.setValue(r,{forceUpdate:!0,notify:!0})},!0),n.addObserver(a=>{JSON.stringify(a)!=JSON.stringify(e.box.getValue())&&e.box.setValue(a,{validate:!0,notify:!0})}),t(rt,{jsonValue:n,style:e.style})}function ne(e){if(!e.test)return t("p",null,"No test");switch(e.test.type){case"form":return n();case"tabs":return l(e.test);case"section":return a(e.test);case"source":return r()}function n(){let i=e.test,o="form"in i?i.form:void 0,s=new se,d=C.enBox(s,null,o.name,o.dataType,"value"in i?i.value:void 0);return t("div",{class:"form-comp"},t(oe,{engine:s,form:o,box:d}),t(ve,{box:d}),t(O,{when:d.type.validations},t("button",{type:"button",class:"btn btn-secondary",onClick:y},"Validate"),t("button",{type:"button",class:"btn btn-secondary",onClick:c},"Clear")));function y(){}function c(){d.clearErrors()}}function a(i){return t("div",{class:"section"},t(O,{when:i.title},t("h1",{class:"display-"+e.level},i.title)),t(O,{when:i.description},t("div",null,i.description)),t(S,{each:i.content},o=>t("div",null,t(ne,{test:o,level:e.level+1}))))}function r(){return t("p",null,"sourceComp")}function l(i){const o=new x("tabsActiveTab",0);let s=i.content;return t(T,null,t(O,{when:i.title},t("h1",{class:"display-"+e.level},i.title)),t(O,{when:i.description},t("p",null,i.description)),t("div",{class:"tabs-container"},t("ul",{class:"nav nav-tabs"},t(S,{each:s},(d,y)=>t("li",{class:"nav-item"},t("button",{class:v("tabsHeader#"+y,{activeTab:o},c=>`nav-link ${y===c.activeTab?"active":""}`),onClick:()=>o.setValue(y)},d.title??y+1)))),t("div",{class:"tab-content mt-3"},t(S,{each:s},(d,y)=>t("div",{class:v("tabsPanel#"+y,{activeTab:o},c=>`tab-pane fade ${y===c.activeTab?"show active":""}`)},t(ne,{test:d,level:e.level+1}))))))}}function lt(){return t("div",{class:"container"},t(W,null),t(ne,{test:it,level:1}))}A.add(".object-members",{"padding-left":"3em"});const xe={type:"object",membersTypes:[{key:"label",type:"string"},{key:"help",type:"string"},{key:"defaultValue",type:"string"},{key:"view",type:"string"},{key:"validations",type:"string"}]},we={type:"object",membersTypes:[{key:"label",type:"string"},{key:"help",type:"string"},{key:"defaultValue",type:"number"},{key:"minValue",type:"number"},{key:"maxValue",type:"number"},{key:"decimals",type:"number"},{key:"view",type:"string"},{key:"validations",type:"string"}]},Te={type:"object",membersTypes:[{key:"label",type:"string"},{key:"help",type:"string"},{key:"entryType",type:"FormType"},{key:"primaryKeys",type:"array",entryType:{type:"string"}},{key:"view",type:"string"},{key:"validations",type:"string"}]},Ve={type:"object",membersTypes:[{key:"value",type:"string"},{key:"help",type:"string"}]},ke={type:"object",membersTypes:[{key:"label",type:"string"},{key:"help",type:"string"},{key:"view",type:"string"},{key:"validations",type:"string"}]},Be={type:"object",membersTypes:[{key:"label",type:"string"},{key:"help",type:"string"},{key:"view",type:"string"},{key:"validations",type:"string"}]},Se={type:"object",membersTypes:[{key:"label",type:"string"},{key:"help",type:"string"},{key:"view",type:"string"},{key:"validations",type:"string"}]},Ce={type:"object",membersTypes:[{key:"label",type:"string"},{key:"help",type:"string"},{key:"membersTypes",type:"array",entryType:{type:"KeyedFormType"}},{key:"view",type:"string"},{key:"validations",type:"string"}]},Ae={type:"object",membersTypes:[{key:"label",type:"string"},{key:"help",type:"string"},{key:"variants",type:"array",entryType:{type:"FormType"}},{key:"determinant",type:"string"},{key:"flat",type:"boolean"},{key:"view",type:"string"},{key:"validations",type:"string"}]},Oe={type:"object",membersTypes:[{key:"label",type:"string"},{key:"help",type:"string"},{key:"view",type:"string"}]},Ie={key:"null",type:"object",membersTypes:[{key:"label",type:"string"},{key:"help",type:"string"}]},De={type:"variant",flat:!0,determinant:"type",variants:[{key:"string",...xe},{key:"number",...we},{key:"object",...Ce},{key:"array",...Te},{key:"const",...Ve},{key:"date",...ke},{key:"datetime",...Be},{key:"time",...Se},{key:"variant",...Ae},{key:"void",...Oe},{key:"null",...Ie}]},N={key:"key",type:"string"},ot={type:"variant",flat:!0,determinant:"type",variants:[{key:"string",type:"object",membersTypes:[{key:"type",type:"const",value:"string"},N,...xe.membersTypes]},{key:"number",type:"object",membersTypes:[{key:"type",type:"const",value:"number"},N,...we.membersTypes]},{key:"object",type:"object",membersTypes:[{key:"type",type:"const",value:"object"},N,...Ce.membersTypes]},{key:"array",type:"object",membersTypes:[{key:"type",type:"const",value:"array"},N,...Te.membersTypes]},{key:"const",type:"object",membersTypes:[{key:"type",type:"const",value:"const"},N,...Ve.membersTypes]},{key:"datetime",type:"object",membersTypes:[{key:"type",type:"const",value:"date"},N,...ke.membersTypes]},{key:"date",type:"object",membersTypes:[{key:"type",type:"const",value:"datetime"},N,...Be.membersTypes]},{key:"time",type:"object",membersTypes:[{key:"type",type:"const",value:"time"},N,...Se.membersTypes]},{key:"variant",type:"object",membersTypes:[{key:"type",type:"const",value:"variant"},N,...Ae.membersTypes]},{key:"void",type:"object",membersTypes:[{key:"type",type:"const",value:"void"},N,...Oe.membersTypes]},{key:"null",type:"object",membersTypes:[{key:"type",type:"const",value:"null"},N,...Ie.membersTypes]}]},ee={version:"1",name:"MetaFormEditor",dataType:{type:"object",membersTypes:[{key:"name",type:"string"},{key:"dataType",...De}]}};function st(){const e=new se({FormType:De,KeyedFormType:ot}),n={name:"My Form",dataType:{type:"string",label:"Enter text",help:"This is a string field"}},a=C.enBox(e,null,ee.name,ee.dataType,n);return t("div",{class:"container"},t(W,null),t("h1",null,"Form Editor"),t(oe,{engine:e,form:ee,box:a}),t(ve,{box:a,style:"height:400px"}))}function ut(){return t(T,null,t("div",{class:"container"},t(W,null),t("h1",null,"Formulaire Bleu"),t("p",null,"Formulaire Bleu est une librairie de formulaires qui vous permet de créer des formulaires pour vos pages web ou vos applications Google Apps en toute simplicité. Avec Formulaire Bleu, vous prenez soin à la fois du créateur du formulaire et de ses utilisateurs.")))}function ct(){return t(T,null,t("div",{class:"container"},t(W,null),t("h1",null,"Cette page n'existe pas")))}new se;function dt(){return v("router",{currentPage:re},e=>{switch(e.currentPage){case"":return t(ut,null);case"#about":return t(Pe,null);case"#form-editor":return t(st,null);case"#tests":return t(lt,null);default:return t(ct,null)}})}const mt=document.getElementById("root");Fe(()=>t(dt,null),mt);
